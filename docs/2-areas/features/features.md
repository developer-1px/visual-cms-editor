# Visual CMS Editor - 기능 명세서

## 핵심 기능

### 1. 이중 모드 시스템 (계획 중)

- **디자인 모드**: 레이아웃과 구조를 정의하는 개발자/디자이너 전용 모드
- **컨텐츠 모드**: 지정된 영역만 편집 가능한 안전한 편집자 모드
- **모드 전환**: 권한 기반 자동 전환

### 2. Loro CRDT 기반 히스토리 시스템

- 모든 변경사항 자동 추적
- 실행 취소/다시 실행 (Undo/Redo)
- 충돌 없는 자동 병합 (협업 기능용)
- 오프라인 작업 후 동기화 (향후 구현)
- 완벽한 변경 이력 추적

### 3. 플러그인 시스템

- 편집 가능한 요소별 플러그인 (텍스트, 이미지, 아이콘, 링크)
- 각 플러그인별 독립적인 동작과 스타일
- 확장 가능한 플러그인 아키텍처
- Strategy Pattern을 통한 유연한 구조

### 4. 편집 가능 영역 (Editable Zones)

- **텍스트 편집**: 인라인 편집, 최대 길이 제한
- **이미지 편집**: 업로드, 교체, 삭제 기능
- **아이콘 편집**: SVG 아이콘 선택 및 교체
- **링크 편집**: URL 편집 모달
- **반복 가능 요소**: 추가, 삭제, 순서 변경
- **자세히 보기 링크**: Features 템플릿에 각 기능별 상세 링크 추가

### 5. 선택 시스템 (Selection System)

- 클릭 기반 단일 선택
- Shift/Cmd+클릭으로 다중 선택
- 키보드 네비게이션 (Tab, Shift+Tab, 화살표 키)
- Escape로 선택 해제
- 타입별 시각적 구분 (색상 코드)

## 구현 상태

### 완료된 기능

- [x] **프로젝트 초기 설정**
  - SvelteKit 2.16.0 + Svelte 5.0.0
  - TypeScript strict mode
  - Tailwind CSS 4.0.0
  - Vite 6.2.6 with WASM support

- [x] **선택 시스템 (Selection System)**
  - 통합 SelectionManager 클래스
  - 반응형 선택 상태 관리
  - 키보드 네비게이션 지원
  - 다중 선택 지원 (Shift/Cmd+Click)
  - 선택 타입별 시각적 스타일링

- [x] **편집 시스템 (Edit System)**
  - 텍스트 인라인 편집 (contentEditable)
  - 이미지 업로드 및 교체
  - 아이콘 선택 팝업
  - 링크 편집 모달
  - Enter/더블클릭으로 편집 모드 진입
  - Escape로 편집 모드 종료

- [x] **플러그인 시스템**
  - EditablePluginManager 구현
  - 텍스트, 이미지, 아이콘, 링크 플러그인
  - 각 플러그인별 독립적인 onClick, onDoubleClick 핸들러
  - 플러그인별 스타일 관리

- [x] **히스토리 시스템**
  - Loro CRDT 기반 구현
  - 텍스트 변경 추적
  - 구조적 변경 추적 (요소 추가/삭제)
  - Undo/Redo 기능 (Cmd/Ctrl+Z, Shift+Cmd/Ctrl+Z)
  - 500ms 디바운싱으로 편집 그룹화
  - 50개 버전 제한

- [x] **템플릿 시스템**
  - 7개 카테고리의 템플릿 (Hero, Features, CTA, Testimonials, Stats, Pricing, Contact)
  - 총 30개 이상의 템플릿
  - 템플릿 선택 모달
  - 드래그 앤 드롭으로 섹션 순서 변경
  - 섹션별 가시성 토글
  - 좌측 사이드바에 섹션 썸네일

- [x] **UI/UX 개선사항**
  - SelectionOverlay 컴포넌트 (floating-ui 기반)
  - 상단 네비게이션 바 재설계
  - 좌측 사이드바 (섹션 관리)
  - 우측 Inspector 패널 (속성 편집, 히스토리)
  - 반응형 디바이스 프리뷰 (데스크톱, 태블릿, 모바일)

- [x] **반복 가능 요소 (Repeatable Elements)**
  - RepeatableActionHandler 구현
  - 요소 복사/붙여넣기
  - 요소 삭제
  - 드래그 앤 드롭 (구현 중)

### 버그 수정

- [x] 스페이스바 입력 시 blur 발생 버그 수정
- [x] 편집 모드 전환 시 선택 상태 유지
- [x] 다중 선택 시 시각적 피드백 개선

### 최근 추가 기능 (2025-01-04)

- [x] **Features 템플릿 자세히 보기 링크**
  - 각 feature 항목에 "자세히 보기" 링크 추가
  - 링크 URL 편집 가능 (data-editable="link")
  - 링크 텍스트 편집 가능 (data-editable="text")
  - 화살표 아이콘 포함

### 진행 중

- [ ] 드래그 앤 드롭으로 반복 요소 순서 변경
- [ ] 이미지 크롭 기능
- [ ] 리치 텍스트 편집기 통합

### 예정된 기능

- [ ] **협업 기능**
  - 실시간 동기화
  - 사용자별 커서 표시
  - 충돌 해결

- [ ] **디자인/컨텐츠 모드 분리**
  - 권한 기반 모드 전환
  - 디자인 모드 전용 기능
  - 컨텐츠 모드 제한사항

- [ ] **저장 및 내보내기**
  - 자동 저장
  - JSON/HTML 내보내기
  - 버전 관리 시스템 통합

- [ ] **프레임워크 어댑터**
  - React 어댑터
  - Vue 어댑터
  - 바닐라 JS 지원

## 기술 스택

### 핵심 기술

- **프레임워크**: SvelteKit 2.16.0 + Svelte 5.0.0
- **언어**: TypeScript 5.0.0 (strict mode)
- **스타일링**: Tailwind CSS 4.0.0
- **빌드 도구**: Vite 6.2.6

### 주요 라이브러리

- **CRDT**: Loro CRDT 1.5.9 (히스토리 및 협업)
- **위치 지정**: @floating-ui/dom (오버레이 포지셔닝)
- **국제화**: Paraglide.js (한국어/영어)

### 개발 도구

- **테스트**: Vitest (단위 테스트), Playwright (E2E)
- **린팅**: ESLint + Prettier
- **타입 체크**: svelte-check

## 아키텍처 특징

### 성능

- 정적 사이트 생성 (SSG) with CSR-only 모드
- 가상화를 통한 대규모 문서 처리
- 효율적인 diff 알고리즘
- 레이지 로딩 지원

### 확장성

- 플러그인 아키텍처
- 커스텀 스토리지 어댑터 (계획 중)
- 테마 시스템 (계획 중)

### 개발자 경험

- 간단한 API
- 완전한 TypeScript 타입 지원
- 데이터 속성 기반 설정
- 개발자 도구 지원
